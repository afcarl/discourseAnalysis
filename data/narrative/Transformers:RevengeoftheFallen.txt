In 17,000 B.C., the Seven Primes traveled the galaxy to create Energon with star-absorbing machines called Sun Harvesters. The Primes followed a rule in which to never destroy planets with life, but one of them, Megatronus Prime, later called The Fallen, deceives the others by building an army in secret and sets up a Sun Harvester on a planet with abundant life, Earth. After defeating ancient humans, The Fallen is confronted by the other Primes who defeat and imprison The Fallen before he can harvest Earth's sun with the Matrix of Leadership, and shortly afterwards sacrifice themselves to hide the Matrix.
Two years after Megatron's demise, the Autobots join the U.S. military to form the Non-Biological Extraterrestrial Species Treaty (NEST), a classified task force hunting down surviving Decepticons, led by William Lennox and Rob Epps. During a mission in Shanghai against the Decepticons Sideways and Demolisher, Optimus Prime learns of The Fallen's return from Demolisher's dying words: "The Fallen will rise again", but is unfamiliar with the name. National Security Adviser Theodore Galloway scolds the task force for their destructive tactics, reminding them that Megatron's corpse is still in the Laurentian Abyss and the last known AllSpark shard is locked up in NEST's headquarters. The Decepticon Communications Officer Soundwave hacks into a U.S. military satellite, eavesdropping for information and sends Ravage to retrieve the shard.
Meanwhile, Sam Witwicky prepares to attend college, leaving his girlfriend Mikaela Banes and guardian Bumblebee behind. While preparing for college, he gets a call from Mikaela. While on the phone, he removes an old jacket from his cupboard; a smaller AllSpark shard falls from within it. He picks up the shard, accidentally channeling its knowledge into his mind, causing him to see Cybertronian symbols and bringing the kitchen appliances to life. After Bumblebee destroys them, Sam gives the shard to Mikaela, who later captures the Decepticon Wheelie when he tries to steal it. The Constructicons resurrect Megatron by using the shard retrieved by Ravage and killing one of their own allies to provide parts for him. Megatron then flies to a moon of Saturn and reunites with his master, The Fallen. The Fallen orders Megatron to capture Sam alive and kill Optimus, who is the last of the Primes and the only Transformer who can defeat him.
Sam, Mikaela, and Leo, Sam's college roommate, are targeted by the Decepticons. Alice, a Pretender Decepticon, first attempts to seduce Sam and then tries to attack him, but Mikaela and Leo enter the room and help him escape. They kill Alice, but are captured by Grindor under the orders of Megatron, who says that the symbols in Sam's mind will lead the Deceptions to a new Energon source. Megatron orders Scalpel to remove Sam's brain, but Optimus and Bumblebee arrive to rescue them. Bumblebee, Leo, and Mikaela escape as Optimus engages Megatron, Starscream, and Grindor in a vicious fight in the forest. Sam watches the three Decepticons overpower Optimus, but Optimus eventually gets the better of Megatron and Starscream; also killing Grindor. As Optimus attempts to find Sam, Megatron mortally stabs him. After encouraging Sam to run, Optimus dies. This forces the humans to retreat as Autobots repel Megatron and Starscream.
The Decepticons prepare for The Fallen's arrival by launching an assault on many areas around the world simultaneously; after landing on Earth, The Fallen, now informed of the death of Optimus, hijacks Earth's telecommunications systems, asking for Sam. In return, the assurance of mankind's survival. Sam, now an international fugitive, enlists the help of Seymour Simmons, who reveals that the Transformers visited Earth eons ago and the most ancient, known as Seekers, live in secret. With the help from Wheelie, they track down an elderly Decepticon named Jetfire, helping the group get to Egypt to find the Matrix of Leadership, which will revive Optimus. Simmons contacts NEST, telling them to bring Optimus and the other Autobots to Egypt.
Sam's group finds the Tomb of the Primes hidden in Petra, but the Matrix disintegrates into dust in Sam's hands. Undeterred, Sam places the Matrix's remains in his sock. Megatron orders the Decepticons to assault the area around the pyramid, leading to a full scale Decepticon attack. NEST and the Autobots land, but they are attacked by a large force of Decepticons. During the battle, Sam reunites with his parents (having found out about the Transformers existence) before getting rescued by Bumblebee, who ends up killing Ravage and Rampage in the process. During the battle, Devastator demolishes one of the Pyramids of Giza, revealing the Sun Harvester inside, before being killed by a strike called in by Simmons. With the Decepticons gaining the upper hand, Lennox and Epps call in an airstrike, which kills a large portion of the Decepticon ground forces. However, Megatron manages to shoot Sam in the confusion, seemingly killing him, before being forced to retreat to the Sun Harvester. Nearing his death, the Seven Primes contact Sam through a vision, telling him the Matrix is earned, and that he earned the right to bear it. They restore Sam's life and the Matrix, which the latter is used to revive Optimus.
The Fallen, sensing the Matrix's restoration and the resurrection of Optimus, teleports to their location and steals the Matrix from Optimus, then returns to the pyramid with Megatron and activates the Sun Harvester. The military assaults the pyramid but are no match to the telekinetic powers of The Fallen, who all but destroys the attack force. A wounded Jetfire sacrifices himself in order for Optimus to gain his parts which gives him immense strength and the ability to fly. Optimus takes to flight and knocks The Fallen and Megatron off the pyramid, destroying the Sun Harvester in the process. The Fallen and Optimus fight ferociously until Megatron appears and attacks Optimus from behind. Optimus uses his new strength to severely injure Megatron, knocking him through a wall and disabling him. Optimus re-engages The Fallen who begins to tear Optimus' new armour apart, but Optimus gains the upper hand by disarming The Fallen and using his own spear against him, impaling him through the shoulder. Wounded, The Fallen attempts to escape, but Optimus rips his face off and crushes his spark out of his chest, finally killing him, while an injured Megatron watches in horror. Vowing vengeance, he retreats with Starscream. Victorious at last, the Autobots and their allies return to the United States as Optimus ends the movie with a victory speech.